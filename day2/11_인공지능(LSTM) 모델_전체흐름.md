# 인공지능(LSTM) 모델을 만들고, 이를 통해 미래 주가를 예측

**삼성전자의 주가 데이터를 수집하여 인공지능(LSTM) 모델을 만들고, 이를 통해 미래 주가를 예측하는 일련의 시스템**입니다.

`learning.py`는 **'공부하는 과정'** 이고, `inference.py`는 공부한 내용을 바탕으로 **'문제를 푸는 과정'** 이라고 볼 수 있습니다.

폴더 구조

```
\day\step4
│  inference.py
│  learning.py
│  requirements.txt
│
├─data
│      price.csv
│
└─model
        samsung_model.h5
        stock_scaler.pkl
```

---

### 1. `learning.py` (모델 학습 및 생성)

과거의 데이터를 바탕으로 주가의 흐름을 학습하여 AI 모델을 만드는 역할을 합니다.

* **데이터 수집:** `FinanceDataReader`를 사용해 2018년부터 현재까지의 삼성전자 주가 데이터를 가져와 CSV 파일로 저장합니다.
* **데이터 전처리 (스케일링):** 주가 데이터(예: 70,000원)는 숫자가 크기 때문에 AI가 공부하기 좋게 **0~1 사이의 값** 으로 변환합니다. 이때 사용한 기준(스케일러)은 나중에 다시 복원하기 위해 따로 저장해둡니다.
* **학습 데이터 구조화:** **"과거 60일치 데이터를 보면 다음 날 주가는 이렇다"** 라는 규칙을 AI에게 가르치기 위해 데이터를 60일 단위로 쪼개서 학습 세트를 만듭니다.
* **신경망 설계 (LSTM):** 시계열 데이터(시간 흐름이 있는 데이터) 처리에 특화된 **LSTM(Long Short-Term Memory)** 알고리즘을 사용하여 모델을 설계하고 학습시킵니다.
* **저장:** 학습이 끝나면 똑똑해진 AI 모델(`samsung_model.h5`)과 데이터 변환 기준(`stock_scaler.pkl`)을 파일로 저장합니다.

---

### 2. `inference.py` (미래 주가 예측 수행)

이미 만들어진 AI 모델을 불러와서 실제로 "내일 주가가 얼마가 될까?"를 계산하는 역할을 합니다.

* **모델 로드:** `learning.py`에서 고생해서 만든 AI 모델과 스케일러를 다시 불러옵니다.
* **최신 데이터 확보:** 예측을 하려면 가장 최근의 데이터가 필요하므로, 실시간으로 최신 삼성전자 주가를 가져옵니다.
* **예측 실행:** 가져온 최신 데이터 중 **가장 최근 60일치**를 AI에게 보여줍니다. AI는 학습했던 기억을 되살려 다음 영업일의 예상치를 내놓습니다.
* **가격 복원:** AI가 내놓은 0~1 사이의 값을 다시 우리가 알아볼 수 있는 **'원' 단위**로 바꾼 뒤 화면에 출력합니다.

---

### 3. 전체 시스템 흐름 요약

1. **데이터 수집:** 삼성전자 주가 정보를 모음.
2. **학습:** LSTM 신경망이 과거 60일의 패턴을 분석하며 주가 변동 규칙을 배움.
3. **예측:** 학습된 규칙을 바탕으로 현재 시점의 데이터를 넣어 내일의 가격을 추측함.
4. **반복:** `learning.py`에서 추가로 학습시킨 슬라이딩 윈도우 방식을 통해 향후 5일치까지의 흐름을 미리 예측해봄.

---

### 4. 실행결과

* 학습 실행 결과

```PowerShell
python .\learning.py 
...
Epoch 1/20
49/49 ━━━━━━━━━━━━━━━━━━━━ 2s 14ms/step - loss: 0.0033
Epoch 2/20
49/49 ━━━━━━━━━━━━━━━━━━━━ 1s 14ms/step - loss: 5.7900e-04
...
Epoch 20/20
49/49 ━━━━━━━━━━━━━━━━━━━━ 1s 15ms/step - loss: 2.3892e-04
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
모델과 스케일러가 저장되었습니다.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 129ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 23ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 22ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 25ms/step

향후 5일간의 예상 주가:
1일 후: 160790원
2일 후: 161400원
3일 후: 160296원
4일 후: 158163원
5일 후: 155434원

```

---

* 예측 실행 결과

```PowerShell
python .\inference.py
...
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 125ms/step
모델이 예측한 다음 영업일의 삼성전자 주가는: 163457원 입니다.
```

---

### 5. 요약

위 코드는 **"삼성전자의 과거 60일간의 움직임을 보고, 통계적으로 가장 가능성 높은 내일의 가격을 맞히는 딥러닝 프로그램"** 입니다.

두 파일의 실행 순서는 당연히 `learning.py`를 먼저 실행하여 모델을 만든 뒤, `inference.py`를 실행하여 결과를 확인하는 방식입니다.

---
