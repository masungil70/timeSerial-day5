import seaborn as sns
import koreanize_matplotlib # 한글 폰트 설정을 위한 라이브러리입니다. matplotlib에서 한글이 깨지는 문제를 해결해줍니다.
import matplotlib.pyplot as plt

# **`barplot()`**은 범주별 데이터의 **평균값**을 막대 높이로 보여주는 대표적인 그래프입니다. 
# 시계열 데이터에 적용하면 연도별 승객 수의 평균적인 성장세와 그에 따른 오차 범위를 한눈에 파악하기 좋습니다.
#
# `barplot()`을 이용한 항공 탑승객 데이터 분석
#
# 아래 코드는 연도를 범주(Category)로 설정하여 각 연도별 승객 수의 
# **평균값**과 **신뢰구간**을 시각화합니다.
#
#① 막대의 높이 (Mean)
# `barplot()`은 기본적으로 해당 범주(연도)에 속하는 데이터들의 **평균값**을 계산하여 
# 막대 높이로 설정합니다.
# 1949년부터 1960년까지 막대 높이가 꾸준히 높아지는 것을 통해 항공 산업의 지속적인 성장을 
# 직관적으로 확인할 수 있습니다.
#
# ② 오차 막대 (Error Bar)
# 막대 상단에 수직으로 그어진 검은 선은 데이터의 **변동성**을 나타냅니다.
# `errorbar="sd"` 설정을 통해 각 연도 내 1~12월 사이의 데이터가 평균에서 얼마나 떨어져
#  있는지(표준편차)를 보여줍니다.
# 뒤로 갈수록 오차 막대가 길어지는 것은 연도가 지날수록 성수기와 비성수기 사이의 격차가 
# 커졌음을 의미합니다.
#
# ③ 범주형 데이터의 시각화
# `flights` 데이터의 연도는 숫자지만, `barplot`에서는 이를 하나의 독립된 **그룹(범주)**으로 
# 취급합니다. 따라서 선 그래프(`lineplot`)처럼 연속적인 흐름보다는 **그룹 간의 명확한 차이**를 
# 비교하는 데 더 유리합니다.
#
# 3. `barplot` 분석 인사이트
# **연간 성장 확인**: 매년 평균 탑승객 수가 약 수십 명 단위로 꾸준히 증가했음을 알 수 있습니다.
# **변동 폭의 변화**: 초창기(1949년)보다 후반기(1960년)의 오차 막대가 더 길기 때문에,
#
# 항공 시장의 규모가 커질수록 월별 데이터의 분산(편차)도 함께 커졌음을 분석할 수 있습니다.
# 이를 통해 항공 산업이 단순히 성장하는 것을 넘어, 계절적 요인에 따른 수요 변화도 더욱 뚜렷해졌다는 
# 사실을 파악할 수 있습니다.

# 1. 데이터 로드
flights = sns.load_dataset("flights")

# 2. barplot 시각화
plt.figure(figsize=(12, 6))
sns.barplot(
    data=flights, 
    x="year",           # X축: 범주형 변수 (연도)
    y="passengers",      # Y축: 수치형 변수 (탑승객 수)
    hue="year",         # 색상: 연도별로 구분 (최신 버전 권장 설정)
    palette="magma",    # 색상 팔레트
    capsize=0.1,        # 오차 막대(Error Bar) 상단의 가로선 크기
    errorbar="sd"       # 오차 막대 표시 방법 ('sd'는 표준편차 표시)
)

# 3. 그래프 꾸미기
plt.title("연도별 평균 항공 탑승객 수 (Bar Plot)")
plt.xlabel("연도 (Year)")
plt.ylabel("평균 탑승객 수 (Mean Passengers)")
plt.grid(axis='y', linestyle='--', alpha=0.5) # 가로선 추가
plt.show()