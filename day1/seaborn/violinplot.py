import seaborn as sns
import koreanize_matplotlib # 한글 폰트 설정을 위한 라이브러리입니다. matplotlib에서 한글이 깨지는 문제를 해결해줍니다.
import matplotlib.pyplot as plt

# **`violinplot()`**은 데이터셋의 통계적 요약(Box plot)과 확률 밀도(KDE)를 한데 시각화 도구 중 하나입니다. 
# `tips` 데이터셋을 활용해 요일별 결제 금액의 분포를 더 입체적으로 분석해 보겠습니다.
#
# `tips` 데이터셋을 활용한 `violinplot()` 예제 
#
# 아래코드는 요일별 결제 금액의 분포를 보여주며, `split=True` 옵션을 통해 성별 간의 차이를 
# 하나의 '바이올린' 안에 합쳐서 비교합니다.
#
# 2. `violinplot` 읽는 법과 특징
#
# 바이올린 플롯은 모양 그 자체가 데이터의 성질을 설명합니다.
#
# **외곽선 (KDE 곡선):** 바이올린의 폭이 넓을수록 해당 금액대의 데이터가 많다는 뜻입니다. 
#   (예: 배가 불룩한 부분에 손님이 가장 많음)
# **내부 점선 (`inner="quart"`):** 바이올린 안에 그려진 세 개의 점선은 
#   각각 **25%(Q1), 50%(중앙값), 75%(Q3)** 지점을 나타냅니다.
# **대칭성:** 기본적으로 좌우 대칭이지만, `split=True`를 사용하면 
#   왼쪽은 남성, 오른쪽은 여성으로 그려 **두 집단의 분포 모양 차이**를 
#   직관적으로 비교할 수 있습니다.
#
# 3. 상세 설명 및 분석 인사이트
#
# **`split=True`**: 이 옵션을 쓰지 않으면 성별마다 바이올린이 따로 그려져 그래프가 복잡해집니다. 
#  이를 합침으로써 "금요일에는 여성이 남성보다 적은 금액대에 더 밀집되어 있구나" 같은 
#  정밀한 비교가 가능해집니다.
#
# **데이터의 '봉우리' 확인**: `boxplot`에서는 알 수 없던 정보입니다. 
#  예를 들어, 어떤 요일의 바이올린이 '조리병 모양'처럼 봉우리가 두 개(Bimodal)라면, 
#  아주 싼 메뉴를 먹는 그룹과 아주 비싼 메뉴를 먹는 그룹으로 손님이 나뉜다는 사실을 알 수 있습니다.
#
# **범위 비교**: 주말(Sat, Sun) 바이올린이 목요일(Thur)보다 위아래로 더 길고 폭이 
#  넓은 것을 통해, 주말에 더 다양한 금액대의 결제가 일어남을 알 수 있습니다.

# 1. 데이터 로드
tips = sns.load_dataset("tips")

# 2. violinplot 시각화
plt.figure(figsize=(12, 7))
sns.violinplot(
    data=tips, 
    x="day",             # X축: 요일
    y="total_bill",      # Y축: 결제 금액
    hue="sex",           # 색상: 성별 구분
    split=True,          # 중요: 바이올린을 반으로 나누어 남/녀 비교
    inner="quart",       # 내부 표시: 사분위수 표시 (stick, box 등 가능)
    palette="muted",
    order=["Thur", "Fri", "Sat", "Sun"]
)

# 3. 그래프 꾸미기
plt.title("요일 및 성별에 따른 결제 금액 분포 (Violin Plot)")
plt.xlabel("요일 (Day)")
plt.ylabel("총 결제 금액 ($)")
plt.show()