# 6. 시계열 이상치 탐지 개념

시계열 데이터에서의 **이상치 탐지(Outlier/Anomaly Detection)**는 데이터의 일반적인 흐름이나 패턴에서 크게 벗어나는 비정상적인 관측치를 찾아내는 기술입니다. 시계열은 시간의 흐름에 따른 '순서'가 중요하기 때문에 일반적인 정적 데이터와는 접근 방식이 조금 다릅니다.

---

## 1. 시계열 이상치의 주요 유형

시계열 데이터에서 나타나는 이상치는 크게 세 가지로 분류할 수 있습니다.

* **글로벌 이상치 (Point Outliers):** 특정 시점의 값이 전체 데이터의 정상 범위를 크게 벗어난 경우입니다. (예: 갑작스러운 서버 트래픽 폭증)
* **컨텍스트 이상치 (Contextual Outliers):** 값 자체는 정상 범위 내에 있지만, 특정 '맥락(시간대, 계절)'상 비정상인 경우입니다. (예: 한여름 낮 기온이 5°C인 경우)
* **집단 이상치 (Collective Outliers):** 개별 데이터 포인트는 정상처럼 보이지만, 특정 구간의 데이터 패턴이 평소와 다른 경우입니다. (예: 심전도 그래프에서 특정 리듬이 깨진 구간)

---

## 2. 이상치 탐지의 핵심 접근 방식

시계열 데이터는 보통 **추세(Trend), 계절성(Seasonality), 잔차(Residual)** 로 구성됩니다. 이를 분해해서 분석하는 것이 기본입니다.

### ① 통계적 방법 (Statistical Methods)

가장 전통적이고 직관적인 방법입니다.

* **Z-Score / IQR:** 평균이나 중앙값에서 표준편차의 n배 이상 떨어진 값을 이상치로 간주합니다.
* **Moving Average (이동 평균):** 윈도우를 설정해 평균을 구하고, 이 범위를 크게 벗어나는 지점을 찾습니다.
* **STL Decomposition:** 데이터를 추세, 계절성, 잔차로 분해한 뒤 '잔차' 부분에서 이상치를 탐지합니다.

### ② 머신러닝 기반 방법 (Machine Learning)

데이터의 분포나 거리를 학습하여 이상치를 구분합니다.

* **Isolation Forest:** 데이터를 무작위로 분할하여 고립(Isolate)시킵니다. 이상치는 정상 데이터보다 더 적은 횟수의 분할만으로도 고립된다는 원리를 이용합니다.
* **One-Class SVM:** 정상 데이터들의 경계를 학습하여, 그 경계 밖에 있는 데이터를 이상치로 판별합니다.

### ③ 딥러닝 기반 방법 (Deep Learning)

복잡하고 비선형적인 패턴을 잡을 때 유리합니다.

* **Autoencoder:** 데이터를 압축했다가 복원하는 과정을 학습합니다. 정상 데이터는 복원이 잘 되지만, 이상치는 복원 오차(Reconstruction Error)가 크게 발생합니다.
* **LSTM-AD:** LSTM 네트워크로 다음 시점의 값을 예측하고, 실제 값과 예측 값의 차이가 크면 이상치로 판단합니다.

---

## 3. 이상치 탐지 프로세스

1. **데이터 전처리:** 결측치 처리, 스케일링, 시간 단위 통일.
2. **구성 요소 분해:** 추세와 계절성을 분리하여 데이터의 '기저 패턴' 파악.
3. **모델 학습 및 점수 산정:** 선택한 알고리즘을 통해 각 데이터 포인트에 '이상치 점수(Anomaly Score)' 부여.
4. **임계값(Threshold) 설정:** 어느 정도 점수부터 이상치로 볼 것인지 결정 (도메인 지식이 중요함).

---

## 주의점

시계열 데이터에서는 **'개념 변화(Concept Drift)'** 를 조심해야 합니다. 과거에는 이상치였던 패턴이 시간이 지나면서 새로운 정상 패턴이 될 수 있기 때문입니다. 따라서 모델을 주기적으로 업데이트하거나 적응형 임계값을 사용하는 것이 좋습니다.
